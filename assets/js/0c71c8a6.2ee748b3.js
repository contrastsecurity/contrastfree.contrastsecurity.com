"use strict";(self.webpackChunkcontrast_dev=self.webpackChunkcontrast_dev||[]).push([[5851],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return f}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),f=a,h=d["".concat(l,".").concat(f)]||d[f]||p[f]||r;return n?i.createElement(h,o(o({ref:t},u),{},{components:n})):i.createElement(h,o({ref:t},u))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<r;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1634:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return f},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var i=n(7462),a=n(3366),r=(n(7294),n(3905)),o=["components"],s={title:"Untrusted Deserialization"},l=void 0,c={unversionedId:"guides/learn-devsec/vulnerabilities/deserialization",id:"guides/learn-devsec/vulnerabilities/deserialization",title:"Untrusted Deserialization",description:"What Is It?",source:"@site/learn/guides/learn-devsec/vulnerabilities/deserialization.md",sourceDirName:"guides/learn-devsec/vulnerabilities",slug:"/guides/learn-devsec/vulnerabilities/deserialization",permalink:"/learn/guides/learn-devsec/vulnerabilities/deserialization",editUrl:"https://github.com/contrastsecurity/contrastfree.contrastsecurity.com/blob/master/learn/guides/learn-devsec/vulnerabilities/deserialization.md",tags:[],version:"current",frontMatter:{title:"Untrusted Deserialization"},sidebar:"docsSidebar",previous:{title:"Cross Site Request Forgery",permalink:"/learn/guides/learn-devsec/vulnerabilities/csrf"},next:{title:"Expression Language Injection / EL Injection",permalink:"/learn/guides/learn-devsec/vulnerabilities/el-injection"}},u={},p=[{value:"What Is It?",id:"what-is-it",level:2},{value:"When Can It Affect My Application?",id:"when-can-it-affect-my-application",level:2},{value:"How Do I Know If and Where I Have This Vulnerability?",id:"how-do-i-know-if-and-where-i-have-this-vulnerability",level:2},{value:"How Do I Fix It?",id:"how-do-i-fix-it",level:2},{value:"How Do People Attack Using This Flaw?",id:"how-do-people-attack-using-this-flaw",level:2}],d={toc:p};function f(e){var t=e.components,n=(0,a.Z)(e,o);return(0,r.kt)("wrapper",(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"what-is-it"},"What Is It?"),(0,r.kt)("p",null,"Untrusted Deserialization occurs when an application deserializes remote data and executes code instructions from the incoming data as part of the process. This results in a remote code execution flaw when attackers embed custom commands into the serialized objects."),(0,r.kt)("h2",{id:"when-can-it-affect-my-application"},"When Can It Affect My Application?"),(0,r.kt)("p",null,"Untrusted Deserialization affects many applications because serialization is often done by a third party library or framework that the application relies on. This vulnerability can occur if any part of the application deserializes data."),(0,r.kt)("h2",{id:"how-do-i-know-if-and-where-i-have-this-vulnerability"},"How Do I Know If and Where I Have This Vulnerability?"),(0,r.kt)("p",null,"Contrast Scan can detect if an application has Untrusted Deserialization by looking at its code."),(0,r.kt)("p",null,"Contrast Assess can detect if an application has Untrusted Deserialization as it is tested."),(0,r.kt)("p",null,"Contrast Protect can permit trusted serialization while blocking untrusted deserialization from exploiting a running system."),(0,r.kt)("h2",{id:"how-do-i-fix-it"},"How Do I Fix It?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Patch any libraries that have serialization flaws."),(0,r.kt)("li",{parentName:"ul"},"Use any serialization filters to create an allow-list of classes."),(0,r.kt)("li",{parentName:"ul"},"Use an alternate serialization format that does not mix data and code.")),(0,r.kt)("h2",{id:"how-do-people-attack-using-this-flaw"},"How Do People Attack Using This Flaw?"),(0,r.kt)("p",null,"Various tools exist to attack deserialization flaws, such as ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/frohoff/ysoserial"},"ysoserial")," and ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/pwntester/ysoserial.net"},"ysoserial.net"),"."),(0,r.kt)("p",null,"Deserialization ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/GrrrDog/Java-Deserialization-Cheat-Sheet"},"attack cheat sheets")," exist for various languages."))}f.isMDXComponent=!0}}]);